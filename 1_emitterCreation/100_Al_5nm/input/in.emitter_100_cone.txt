# lammps script for generation of a conical emitter with 5 nm radius with (100) orientation
# the script will generate three files: Material.txt, Vaccum.txt, Fixed.txt
# Material.txt: inner conical + spherical tip (solid center)
# Vaccum.txt: outer emitter shape (shaft + spherical cap) minus material (hollow shell),
# Fixed.txt: contains the lattice points of the fixed region

# intialization of the simulation settings
echo                both
units               metal
dimension           3
atom_style          atomic
boundary            f f f

# atom definition for emitter
region             both block 0 400 0 400 0 800
region             shaft cylinder z 200 200 55 0 200
region             top sphere 200 200 200 55
region             apttip union 2 top shaft

region             innertop sphere 200 200 200 50
region             innerbot cylinder z 200 200 50 0 200
region             special cylinder z 200 200 50 0 1
region             innertip union 2 innertop innerbot
region             bottom block 0 400 0 400 0 1


create_box         1 both ## change the value from 1 to 2 for two atom types

# orientation of the emitter
lattice            fcc 4.05 orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
create_atoms       1 region both ## means the emitter is made of type 1 atoms

# Force field settings
pair_style         eam/alloy
pair_coeff         * * ../../../resources/potentials/Al99.eam.alloy Al

# group definitions to cut out the emitter
group              sim region apttip
group              kill subtract all sim
delete_atoms       group kill

# material = solid cone + tip inside emitter
group              material region innertip
set                group material type/fraction 1 0.02 1394 ## change the value of the type to 2 for two atom types

# Fixed region = bottom layer excluding special and material
group              prefixed region special
group              fixed subtract prefixed material

# vaccum = emitter shell minus solid core and fixed base
group              vaccum subtract sim material fixed
group              freeze region bottom

# output configuration
thermo_style       custom step temp press vol pe etotal pxx pyy pzz lx lz
thermo_modify      lost ignore
thermo             100

# energy minimization of the structure
fix                1 freeze setforce NULL NULL 0
min_style          cg 
minimize           0.0 1e-10 50000 5000000

# dumping the configuration settings into output files
reset_timestep     0
dump               1 material custom 1 Material.txt x y z type
dump_modify        1 format line "%20.15g %g %g %d"
dump               2 vaccum custom 1 Vaccum.txt x y z type
dump_modify        2 format line "%g %g %g %d"
dump               3 fixed custom 1 Fixed.txt x y z type
dump_modify        3 format line "%g %g %g %d"
run                0